<html
  xmlns="http://www.w3.org/1999/xhtml"
  xml:lang="en"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  lang="en"
  metal:use-macro="context/main_template/macros/master"
  i18n:domain="eea">
  <body>

    <metal:main fill-slot="main">
    <style>
h1 { margin-bottom: 0 }
h1+p { margin-bottom: 3rem; }
.dataTables_wrapper {
  border: 1px solid #CCC;
  padding: 0.6rem;
}
.item-section {
  padding-bottom: 2rem;
}
.item-section h2 {
  margin-bottom: 0;
}
.item-section h2+a {
  display: block;
  margin-bottom: 1rem;
}

    </style>
    <h1 tal:content="context/Title">Personal dashboard</h1>
    <!-- <div tal:replace="structure context/text/output">
      <p>Here you can find an overview of your personally created Climate-Adapt
      content.
      </p>
    </div> -->
      <tal:item repeat="item view/items">
        <div class="item-section"
          tal:define="name python:item['name']; portal_type python:item['portal_type'];"
          >
          <h2 tal:define="count python:len(item['entries']);
          items_label python: (count == 0 or count > 1) and 'items' or 'item'">
            <tal:portal_type replace="python: view.plural(name)" />
            (<tal:count replace="count" /> <tal:i replace='items_label' />)
          </h2>
          <a
            tal:attributes="href string:${portal_url}/${item/path}/++add++/${portal_type}">Add new <tal:name replace="name" /></a>
          <div class="type-section">
            <table class="listing">
              <thead>
                <tr>
                  <th>Title</th>
                  <th>Created</th>
                  <th>Modified</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <tal:entry repeat="entry python:item['entries']">
                <tr>
                  <td><a tal:attributes="href entry/url" tal:content="entry/title"></a></td>
                  <td>
                    <time tal:content="entry/created"></time>
                    <!-- (<a tal:attributes="href string:${portal_url}/author/${entry/user_id}" tal:content="entry/user_name"></a>) -->
                  </td>
                  <td>
                    <time tal:content="entry/modified"></time>
                  </td>
                  <td>
                    <time tal:content="entry/review_state"></time>
                  </td>
                </tr>
                </tal:entry>
              </tbody>
            </table>
          </div>
        </div>
      </tal:item>
      <script>
        $('.type-section table').dataTable();
      </script>
    </metal:main>

  </body>
</html>
