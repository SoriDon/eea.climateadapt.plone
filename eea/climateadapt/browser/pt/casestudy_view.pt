<html
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    xml:lang="en"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="eea.climateadapt">

    <body>
        <metal:main fill-slot="body">
            <tal:main-macro metal:define-macro="content-core">

                <link rel="stylesheet" href="//blueimp.github.io/Gallery/css/blueimp-gallery.min.css">
                <link rel="stylesheet" href="++theme++climateadapt/static/cca/css/bootstrap-image-gallery.min.css">
                <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
                <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" media="all">

                <tal:def define="primephoto context/primary_photo; supphotos python:context.contentValues({'portal_type':'Image'}); ">

                  <metal:macro use-macro="context/ace_macros/macros/ace_layout">

                    <div metal:fill-slot="title-slot"></div>
                    <div metal:fill-slot="ace-left-slot">
                      <div class="case-studies-top">
                        <div metal:use-macro="context/ace_macros/macros/title_date"></div>
                        <div class="case-studies-review-image-wrapper" tal:condition="primephoto">
                          <img tal:condition="primephoto" tal:replace="structure context/@@images/primary_photo/mini"/>
                          <div tal:content="context/primary_photo_copyright" class="image-copyright"/>
                        </div>
                        <div class="case-studies-top-title">
                          <div tal:content="structure python: view.w['long_description'].render()">
                            Description
                          </div>
                        </div>
                      </div>

                      <div class="case-studies-review-clearing"></div>

                      <div class="case-studies-tabbed-content-section">
                        <ul>
                          <li class="first submenu">
                            <p>
                              <em>Case Study Description</em>
                            </p>
                            <ul class="case-studies-tabbed-content-bullted-list">
                              <li class="first">
                                <a href="#challenges_anchor" style="text-decoration: underline">Challenges</a>
                              </li>
                              <li>
                                <a href="#objectives_anchor" style="text-decoration: underline">Objectives</a>
                              </li>
                              <li tal:condition="view/get_adaptation_options | nothing">
                                <a href="#adapt_options_anchor" style="text-decoration: underline">Adaptation Options Implemented In This Case</a>
                              </li>
                              <li>
                                <a href="#solutions_anchor" style="text-decoration: underline">Solutions</a>
                              </li>
                              <li class="last">
                                <a href="#relevance_anchor" style="text-decoration: underline">Importance and Relevance of Adaptation</a>
                              </li>
                            </ul>
                          </li>
                          <li class="submenu">
                            <p>
                              <em>Additional Details</em>
                            </p>
                            <ul class="case-studies-bullted-list">
                              <li class="first" tal:condition="context/stakeholder_participation | nothing">
                                <a href="#stake_holder_anchor" style="text-decoration: underline">Stakeholder Participation</a>
                              </li>
                              <li tal:condition="context/success_limitations | nothing">
                                <a href="#success_limitations_anchor" style="text-decoration: underline">Success and Limiting Factors</a>
                              </li>
                              <li tal:condition="context/cost_benefit | nothing">
                                <a href="#cost_benefit_anchor" style="text-decoration: underline">Costs and Benefits</a>
                              </li>
                              <li tal:condition="python: context.legal_aspects is not None">
                                <a href="#legal_aspects" style="text-decoration: underline">Legal Aspects</a>
                              </li>
                              <li tal:condition="python: context.implementation_time is not None">
                                <a href="#implementation_time_anchor" style="text-decoration: underline">Implementation Time</a>
                              </li>
                              <li class="last" tal:condition="python: context.lifetime is not None">
                                <a href="#life_time_anchor" style="text-decoration: underline">Life Time</a>
                              </li>
                            </ul>
                          </li>
                          <li class="last submenu">
                            <p>
                              <em>Reference Information</em>
                            </p>
                            <ul class="case-studies-bullted-list">
                              <li class="first">
                                <a href="#contact" style="text-decoration: underline">Contact</a>
                              </li>
                              <li tal:define="links python:view.get_websites()" tal:condition="links">
                                <a href="#websites" style="text-decoration: underline">Websites</a>
                              </li>
                              <li class="last" tal:condition="context/source | nothing">
                                <a href="#source" style="text-decoration: underline">Source</a>
                              </li>
                            </ul>
                          </li>
                        </ul>

                        <div class="case-studies-case-studies-review-clearing-clearing"></div>
                      </div>
                      <div id="case-study-selector-em">

                        <h4>Case Study Description</h4>
                        <em id="challenges_anchor" style="text-decoration: underline">Challenges</em>
                        <div tal:content="structure python: view.w['challenges'].render()"></div>

                        <em id="objectives_anchor" style="text-decoration: underline">Objectives</em>
                        <p tal:replace="structure python: view.w['objectives'].render()"></p>

                        <div tal:condition="view/get_adaptation_options | nothing">
                          <em id="adapt_options_anchor" style="text-decoration: underline">Adaptation Options Implemented In This Case</em>
                          <div tal:define="adaptations view/get_adaptation_options" tal:on-error="nothing">
                            <a tal:repeat="obj adaptations" tal:attributes="href obj/absolute_url" tal:content="obj/Title" style="text-decoration: underline">Link</a>
                          </div>
                        </div>

                        <em id="solutions_anchor" style="text-decoration: underline">Solutions</em>
                        <p tal:replace="structure python: view.w['solutions'].render()"></p>

                        <em id="relevance_anchor" style="text-decoration: underline">Relevance</em>
                        <p tal:repeat="rel context/relevance">
                          <span tal:replace="python: view.relevances_dict()[rel]"></span>
                        </p>

                        <h4>Additional Details</h4>
                        <div tal:condition="context/stakeholder_participation | nothing">
                            <em id="stake_holder_anchor" style="text-decoration: underline">Stakeholder Participation</em>
                            <div tal:content="structure python: view.w['stakeholder_participation'].render()"></div>
                        </div>

                        <div tal:condition="context/success_limitations | nothing">
                            <em id="success_limitations_anchor" style="text-decoration: underline">Success and Limiting Factors</em>
                            <div tal:content="structure python: view.w['success_limitations'].render()"></div>
                        </div>

                        <div tal:condition="context/cost_benefit | nothing">
                            <em id="cost_benefit_anchor" style="text-decoration: underline">Costs and Benefits</em>
                            <div tal:content="structure python: view.w['cost_benefit'].render()"></div>
                        </div>

                        <em id="legal_aspects" tal:condition="python: context.legal_aspects is not None"
                            style="text-decoration: underline">Legal Aspects</em>
                        <div tal:content="structure python: view.w['legal_aspects'].render()"></div>

                        <em id="implementation_time_anchor" style="text-decoration: underline"
                          tal:condition="python: context.implementation_time is not None">Implementation Time</em>
                        <div tal:content="structure context/implementation_time/output | nothing"></div>

                        <em id="life_time_anchor" tal:condition="python: context.lifetime is not None"
                            style="text-decoration: underline">Life Time</em>
                        <div tal:content="structure context/lifetime/output | nothing"></div>

                        <h4 class="reference-title">Reference Information</h4>
                        <em id="contact" style="text-decoration: underline">Contact</em>
                        <div tal:content="structure python: view.w['contact'].render()"></div>

                        <div tal:define="links python:view.get_websites()"
                             tal:condition="links">
                            <em id="websites" style="text-decoration: underline">Websites</em>
                            <div metal:use-macro="context/ace_macros/macros/websites"></div>
                        </div>

                        <div tal:content="structure provider:plone.abovecontentbody" />

                        <div tal:condition="context/source | nothing">
                            <em id="source" style="text-decoration: underline">Source</em>
                            <div tal:content="structure context/source | nothing"></div>
                        </div>
                        <div metal:use-macro="context/ace_macros/macros/comments"></div>
                      </div>
                    </div>

                    <div metal:fill-slot="ace-right-slot">

                      <div class="case-studies-illustrations" tal:condition="supphotos">
                        <div id="blueimp-gallery"
                             class="blueimp-gallery blueimp-gallery-controls"
                             data-use-bootstrap-modal="false">
                          <div class="slides"></div>
                          <h3 class="title"></h3>
                          <p class="description"></p>
                          <a class="prev">‹</a>
                          <a class="next">›</a>
                          <a class="close">×</a>
                          <p class="casestudies-gallery-copyright"></p>
                          <a class="play-pause"></a>
                          <ol class="indicator"></ol>
                        </div>
                        <div id="links">
                          <span>
                            Case Study Illustrations (<span tal:replace="python:len(supphotos)"/>)
                            <i class="fa fa-camera"></i>
                          </span>
                          <div tal:repeat="photo supphotos" class="gallery-hide" style="display:none;">
                            <a data-gallery href="" title=""
                                data-description="Something"
                                tal:attributes="href string:${photo/absolute_url}/@@images/image/large;
                                title photo/Title;
                                data-description photo/description;
                                data-copyright photo/rights">
                                <img tal:attributes="src string:${photo/absolute_url}/@@images/image/medium" />
                            </a>
                          </div>
                        </div>
                      </div>

                      <div metal:use-macro="context/ace_macros/macros/files"></div>
                      <h4>Keywords:</h4>
                      <div metal:use-macro="context/ace_macros/macros/keywords"></div>
                      <h4>Sectors:</h4>
                      <div tal:content="structure python:view.w['sectors'].render()"/>
                      <h4>Climate impacts:</h4>
                      <div tal:content="structure python:view.w['climate_impacts'].render()"/>
                      <div tal:condition="python: view.governance_level() != ''">
                        <h4>Governance level:</h4>
                        <div tal:repeat="level python: view.governance_level()">
                          <span tal:content="level"></span>
                        </div>
                      </div>
                      <h4>Geographic characterization:</h4>
                      <div metal:use-macro="context/ace_macros/macros/geochar"></div>
                    </div>
                  </metal:macro>

                </tal:def>
                <!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> -->
                <!-- <script src="//blueimp.github.io/Gallery/js/jquery.blueimp-gallery.min.js"></script> -->
                <script tal:define="portal_state context/@@plone_portal_state"
                        tal:condition="python: portal_state.anonymous() == True"
                        src="//blueimp.github.io/Gallery/js/jquery.blueimp-gallery.min.js">
                </script>

                <script tal:define="portal_state context/@@plone_portal_state"
                        tal:condition="python: portal_state.anonymous() != True">
                    require.config({
                        paths: {
                            // 'jquery': '//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min',
                            'blueimp': '//blueimp.github.io/Gallery/js/jquery.blueimp-gallery.min',
                            'blueimp-helper': '//blueimp.github.io/Gallery/js/blueimp-helper',
                            'blueimp-gallery': '//blueimp.github.io/Gallery/js/blueimp-gallery',
                        },
                        shim: {
                            'blueimp': ['blueimp-gallery', 'blueimp-helper']
                        }
                    });
                    require(['jquery', 'blueimp'], function($, blueimp) {
                        if (document.getElementById('links') != null) {
                            document.getElementById('links').onclick = function (event) {
                              event = event || window.event;
                              var target = event.target || event.srcElement,
                                link = target.src ? target.parentNode : target,
                                options = {
                                  index: link, event: event,
                                  onslide: function (index, slide) {

                                    self = this;
                                    var initializeAdditional = function (index, data, klass, self) {
                                      var text = self.list[index].getAttribute(data),
                                        node = self.container.find(klass);
                                      node.empty();
                                      if (text) {
                                        node[0].appendChild(document.createTextNode(text));
                                      }
                                    };
                                    initializeAdditional(index, 'data-description', '.description', self);
                                    initializeAdditional(index, 'data-copyright', '.casestudies-gallery-copyright', self);
                                  }
                                },
                                links = this.getElementsByTagName('a');
                              blueimp(links, options);
                            };
                        }
                    });
                </script>
                <div id="viewlet-below-content-body" tal:content="structure provider:plone.belowcontentbody" tal:condition="not:ajax_load" />

            </tal:main-macro>
        </metal:main>

    </body>
</html>
