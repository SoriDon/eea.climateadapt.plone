!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.d3=a.d3||{})}(this,function(a){"use strict";function b(a){this._size=a,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}function c(a){if(!a._start)try{d(a)}catch(b){if(a._tasks[a._ended+a._active-1])f(a,b);else if(!a._data)throw b}}function d(a){for(;a._start=a._waiting&&a._active<a._size;){var b=a._ended+a._active,c=a._tasks[b],d=c.length-1,f=c[d];c[d]=e(a,b),--a._waiting,++a._active,c=f.apply(null,c),a._tasks[b]&&(a._tasks[b]=c||j)}}function e(a,b){return function(d,e){a._tasks[b]&&(--a._active,++a._ended,a._tasks[b]=null,null==a._error&&(null!=d?f(a,d):(a._data[b]=e,a._waiting?c(a):g(a))))}}function f(a,b){var c,d=a._tasks.length;for(a._error=b,a._data=void 0,a._waiting=NaN;--d>=0;)if((c=a._tasks[d])&&(a._tasks[d]=null,c.abort))try{c.abort()}catch(b){}a._active=NaN,g(a)}function g(a){if(!a._active&&a._call){var b=a._data;a._data=void 0,a._call(a._error,b)}}function h(a){if(null==a)a=1/0;else if(!((a=+a)>=1))throw new Error("invalid concurrency");return new b(a)}var i=[].slice,j={};b.prototype=h.prototype={constructor:b,defer:function(a){if("function"!=typeof a)throw new Error("invalid callback");if(this._call)throw new Error("defer after await");if(null!=this._error)return this;var b=i.call(arguments,1);return b.push(a),++this._waiting,this._tasks.push(b),c(this),this},abort:function(){return null==this._error&&f(this,new Error("abort")),this},await:function(a){if("function"!=typeof a)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=function(b,c){a.apply(null,[b].concat(c))},g(this),this},awaitAll:function(a){if("function"!=typeof a)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=a,g(this),this}},a.queue=h,Object.defineProperty(a,"__esModule",{value:!0})});